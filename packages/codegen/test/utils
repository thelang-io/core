/*!
 * Copyright (c) Aaron Delasy
 * Licensed under the MIT License
 */

export obj TestFileSections {
  mut input: str
  mut code: str
  mut output: str
}

export fn retrieveFileSections (path: str) TestFileSections {
  content := fs_readFileSync(path).str()
  lines := content.lines(keepLineBreaks: true)
  l := lines.len

  mut result := TestFileSections{}
  mut propertyId := 0

  loop i := 0; i < l; i++ {
    line := lines[i]

    if "=====" == line.slice(0, 5) {
      propertyName := line.trim().slice(6, -6)

      if "code" == propertyName {
        propertyId = 1
      } elif "output" == propertyName {
        propertyId = 2
      }

      continue
    }

    if 0 == propertyId {
      result.input += line
    } elif 1 == propertyId {
      result.code += line
    } elif 2 == propertyId {
      result.output += line
    }
  }

  return result
}

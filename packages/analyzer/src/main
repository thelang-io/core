/*!
 * Copyright (c) Aaron Delasy
 * Licensed under the MIT License
 */

import analyze from "./analyzer"
import * as Parser from "the/parser"

main {
  args := process_args

  if args.len == 1 {
    print("First argument is not specified", to: "stderr")
    process_exit(1)
  }

  mut f := Parser.parse(args[1])
  Parser.interconnect(ref f)
  errors := analyze(ref f)

  if errors.len != 0 {
    print()

    loop i := 0; i < errors.len; i++ {
      if i != 0 { print(to: "stderr") }
      print(errors[i] as str, terminator: "", to: "stderr")
    }

    process_exit(1)
  }
}
